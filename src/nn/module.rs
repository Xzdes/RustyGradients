use crate::tensor::Tensor;
// --- ИЗМЕНЕНИЕ: Импортируем наш новый тип Result ---
use crate::error::Result;

/// Трейт, определяющий общий интерфейс для всех слоев/модулей.
/// Любой компонент, который может быть частью нейронной сети, должен его реализовывать.
pub trait Module {
    /// Выполняет прямой проход через модуль.
    /// Принимает входной тензор и возвращает выходной.
    ///
    // --- ИЗМЕНЕНИЕ: Теперь функция возвращает `Result<Tensor>` ---
    /// Может вернуть ошибку `RustyGradientsError`, если что-то пошло не так
    /// (например, из-за несовместимости форм тензоров).
    fn forward(&self, inputs: &Tensor) -> Result<Tensor>;

    /// Возвращает список всех обучаемых параметров модуля в виде вектора тензоров.
    /// Если у модуля есть вложенные модули, он должен рекурсивно собрать их параметры.
    fn parameters(&self) -> Vec<Tensor>;
}